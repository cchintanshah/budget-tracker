/* ═══════════════════════════════════════════
   VARIABLES
   ═══════════════════════════════════════════ */
:root {
  --pri: #4F46E5; --pri-light: #818CF8; --green: #10B981; --red: #EF4444;
  --amber: #F59E0B; --orange: #F97316;
  --bg: #F1F5F9; --card: #FFFFFF; --text: #1E293B; --text2: #64748B;
  --border: #E2E8F0; --sb: #0F172A; --sb-txt: #CBD5E1;
  --radius: 12px;
  --shadow: 0 1px 3px rgba(0,0,0,.08), 0 1px 2px rgba(0,0,0,.06);
  --shadow-lg: 0 10px 15px -3px rgba(0,0,0,.08);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); }

/* ═══════════════ LAYOUT ═══════════════ */
.app { display: flex; min-height: 100vh; }

/* Sidebar */
.sidebar {
  width: 60px; background: var(--sb); color: var(--sb-txt);
  display: flex; flex-direction: column; transition: width .25s;
  position: fixed; top: 0; left: 0; bottom: 0; z-index: 100;
}
.sidebar.open { width: 240px; }
.sb-head { display: flex; align-items: center; justify-content: space-between; padding: 16px; height: 64px; border-bottom: 1px solid rgba(255,255,255,.08); }
.sb-head h2 { font-size: 18px; color: #fff; white-space: nowrap; }
.sb-toggle { background: none; border: none; color: var(--sb-txt); font-size: 20px; cursor: pointer; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 6px; }
.sb-toggle:hover { background: rgba(255,255,255,.1); }
.sb-nav { flex: 1; padding: 8px; display: flex; flex-direction: column; gap: 2px; }
.sb-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border: none; background: none; color: var(--sb-txt); font-size: 14px; border-radius: 8px; cursor: pointer; text-align: left; width: 100%; transition: all .15s; }
.sb-item:hover { background: rgba(255,255,255,.08); color: #fff; }
.sb-item.active { background: var(--pri); color: #fff; }
.sb-icon { font-size: 20px; min-width: 24px; text-align: center; }

.sb-file-info {
  padding: 12px 16px; border-top: 1px solid rgba(255,255,255,.08);
  display: flex; align-items: center; gap: 8px; font-size: 12px;
}
.file-dot { width: 8px; height: 8px; border-radius: 50%; }
.file-dot.green { background: #4ADE80; }
.file-dot.gray { background: #64748B; }

.overlay { position: fixed; inset: 0; background: rgba(0,0,0,.4); z-index: 90; }

/* Main */
.main { flex: 1; margin-left: 60px; transition: margin-left .25s; }
.sidebar.open ~ .main { margin-left: 240px; }

/* Topbar */
.topbar {
  height: 64px; background: var(--card); border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 20px; position: sticky; top: 0; z-index: 50; box-shadow: var(--shadow);
}
.tb-left { display: flex; align-items: center; gap: 12px; }
.tb-left h1 { font-size: 18px; font-weight: 700; }
.mob-menu { display: none; background: none; border: none; font-size: 22px; cursor: pointer; }
.tb-right { display: flex; align-items: center; gap: 8px; }
.tb-divider { width: 1px; height: 28px; background: var(--border); margin: 0 4px; }

.ym-sel {
  padding: 7px 10px; border: 1px solid var(--border); border-radius: 8px;
  font-size: 13px; background: #fff; cursor: pointer; color: var(--text); font-weight: 600;
}
.month-sel-dd { min-width: 110px; }

.btn { padding: 7px 14px; border: none; border-radius: 8px; font-size: 13px; cursor: pointer; font-weight: 600; transition: all .15s; display: inline-flex; align-items: center; gap: 5px; }
.btn-pri { background: var(--pri); color: #fff; }
.btn-pri:hover { background: #4338CA; }
.btn-sec { background: var(--bg); color: var(--text); border: 1px solid var(--border); }
.btn-sec:hover { background: var(--border); }
.btn-danger { background: #FEE2E2; color: var(--red); border: 1px solid #FECACA; }
.btn-danger:hover { background: #FECACA; }
.btn-file { background: none; border: 1px solid var(--border); font-size: 16px; padding: 5px 8px; border-radius: 6px; }
.btn-file:hover { background: var(--bg); }

.save-badge { font-size: 14px; padding: 4px 8px; border-radius: 6px; }
.save-badge.saved { background: #D1FAE5; }
.save-badge.saving, .save-badge.pending { background: #FEF3C7; }
.save-badge.error { background: #FEE2E2; }

.content { padding: 24px; }

/* ═══════════════ FILE BANNER ═══════════════ */
.file-banner {
  background: linear-gradient(135deg, #EEF2FF, #E0E7FF); border-bottom: 1px solid #C7D2FE;
  padding: 16px 24px; display: flex; align-items: center; gap: 16px;
}
.file-banner span { font-size: 32px; }
.file-banner strong { font-size: 15px; color: var(--pri); display: block; margin-bottom: 2px; }
.file-banner p { font-size: 13px; color: var(--text2); margin: 0; }
.fb-actions { margin-left: auto; display: flex; gap: 8px; }

.reminder-banner {
  background: linear-gradient(135deg, #FEF3C7, #FDE68A); color: #92400E;
  padding: 10px 24px; display: flex; align-items: center; gap: 12px; font-size: 14px;
}
.reminder-banner button { background: #F59E0B; color: #fff; border: none; padding: 5px 12px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-left: auto; }

/* ═══════════════ SHEET BADGE ═══════════════ */
.sheet-badge-bar {
  padding: 8px 24px; background: #F8FAFC; border-bottom: 1px solid var(--border);
  display: flex; align-items: center; gap: 10px; font-size: 13px;
}
.sheet-label { color: var(--text2); }
.sheet-name { font-weight: 800; color: var(--pri); background: #EEF2FF; padding: 3px 10px; border-radius: 6px; }
.sheet-exists { color: var(--green); font-size: 12px; }
.sheet-new { color: var(--amber); font-size: 12px; }

/* ═══════════════ CARDS ═══════════════ */
.card { background: var(--card); border-radius: var(--radius); padding: 24px; box-shadow: var(--shadow); margin-bottom: 20px; border: 1px solid var(--border); }
.card h3 { font-size: 16px; margin-bottom: 16px; }
.card-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
.card-head h3 { margin-bottom: 0; }

.cards-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin-bottom: 24px; }
.sum-card { background: var(--card); border-radius: var(--radius); padding: 18px; display: flex; align-items: center; gap: 14px; box-shadow: var(--shadow); border: 1px solid var(--border); transition: transform .15s; }
.sum-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.sc-icon { font-size: 30px; width: 52px; height: 52px; border-radius: 12px; display: flex; align-items: center; justify-content: center; }
.sum-card.inc .sc-icon { background: #D1FAE5; }
.sum-card.exp .sc-icon { background: #FEE2E2; }
.sum-card.sav .sc-icon { background: #DBEAFE; }
.sum-card.utl .sc-icon { background: #FFEDD5; }
.sc-info { display: flex; flex-direction: column; }
.sc-label { font-size: 12px; color: var(--text2); font-weight: 500; }
.sc-value { font-size: 20px; font-weight: 800; margin-top: 2px; }
.sc-sub { font-size: 11px; margin-top: 3px; font-weight: 600; }

/* ═══════════════ TENANT BANNERS ═══════════════ */
.tenant-overage-banner {
  background: linear-gradient(135deg, #FEF2F2, #FECACA); border: 2px solid #F87171;
  border-radius: var(--radius); padding: 18px 22px; display: flex; align-items: center;
  justify-content: space-between; margin-bottom: 24px; animation: pulse-border 2s ease-in-out infinite;
}
@keyframes pulse-border { 0%,100% { border-color: #F87171; } 50% { border-color: #DC2626; } }
.tob-left { display: flex; align-items: center; gap: 14px; }
.tob-icon { font-size: 32px; width: 50px; height: 50px; background: #FEE2E2; border-radius: 12px; display: flex; align-items: center; justify-content: center; }
.tob-left h4 { font-size: 15px; color: #991B1B; margin-bottom: 3px; }
.tob-left p { font-size: 12px; color: #B91C1C; max-width: 350px; margin: 0; }
.tob-right { text-align: center; padding: 10px 20px; background: #DC2626; border-radius: 12px; }
.tob-amount { display: block; font-size: 24px; font-weight: 900; color: #fff; }
.tob-label { display: block; font-size: 10px; font-weight: 700; color: #FECACA; text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }

.tenant-zero-banner { background: #D1FAE5; border: 1px solid #A7F3D0; border-radius: var(--radius); padding: 14px 18px; display: flex; align-items: center; gap: 12px; margin-bottom: 24px; font-size: 13px; }
.tenant-zero-banner span { font-size: 26px; }
.tenant-zero-banner strong { color: #065F46; display: block; margin-bottom: 1px; }
.tenant-zero-banner p { color: #047857; font-size: 12px; margin: 0; }

/* ═══════════════ OUTFLOW SUMMARY ═══════════════ */
.outflow-summary { background: var(--card); border-radius: var(--radius); padding: 18px; box-shadow: var(--shadow); border: 1px solid var(--border); margin-bottom: 24px; }
.os-row { display: flex; justify-content: space-between; padding: 9px 12px; font-size: 14px; border-bottom: 1px solid var(--border); }
.os-row:last-child { border-bottom: none; }
.os-row.tenant-row { background: #FEF2F2; border-radius: 6px; border: 1px dashed #F87171; margin: 3px 0; }
.tenant-highlight { color: #DC2626; font-weight: 800; }
.os-total { background: var(--sb); color: #fff; border-radius: 8px; font-weight: 700; font-size: 15px; margin-top: 6px; }
.os-savings { margin-top: 4px; border-radius: 8px; font-weight: 700; }
.os-savings.positive { background: #D1FAE5; color: #065F46; }
.os-savings.negative { background: #FEE2E2; color: #991B1B; }

/* ═══════════════ CHARTS ═══════════════ */
.charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
.chart-card { background: var(--card); border-radius: var(--radius); padding: 24px; box-shadow: var(--shadow); border: 1px solid var(--border); }
.chart-card h3 { font-size: 14px; margin-bottom: 14px; }
.empty-chart { height: 200px; display: flex; align-items: center; justify-content: center; color: var(--text2); font-style: italic; }

.cat-bars { display: flex; flex-direction: column; gap: 10px; }
.cat-bar-row { display: flex; align-items: center; gap: 8px; }
.cat-bar-row.tenant-bar { background: #FEF2F2; border: 1px dashed #F87171; border-radius: 8px; padding: 5px 8px; }
.cb-name { font-size: 11px; color: var(--text2); min-width: 90px; text-align: right; }
.tenant-bar .cb-name { color: #DC2626; font-weight: 700; }
.cb-track { flex: 1; height: 20px; background: var(--bg); border-radius: 6px; overflow: hidden; }
.cb-fill { height: 100%; border-radius: 6px; transition: width .4s ease; min-width: 4px; }
.cb-val { font-size: 12px; font-weight: 700; min-width: 70px; }

/* ═══════════════ BUDGET SUMMARY CARD ═══════════════ */
.budget-summary-card { border: 2px solid var(--pri); }
.budget-summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 14px; }
.bs-item { padding: 14px; border-radius: 10px; background: #F8FAFC; text-align: center; border: 1px solid var(--border); }
.bs-label { display: block; font-size: 11px; font-weight: 600; color: var(--text2); text-transform: uppercase; letter-spacing: .5px; margin-bottom: 6px; }
.bs-value { display: block; font-size: 20px; font-weight: 900; }
.bs-tenant-active { background: #FEF2F2 !important; border: 2px dashed #F87171 !important; animation: pulse-bg 2s ease-in-out infinite; }
@keyframes pulse-bg { 0%,100% { background: #FEF2F2; } 50% { background: #FECACA; } }
.bs-tenant-active .bs-value { color: #DC2626; }
.bs-tenant-zero { background: #F0FDF4 !important; border: 1px solid #BBF7D0 !important; }
.bs-tenant-zero .bs-value { color: #16A34A; }
.bs-total { background: var(--sb) !important; border-color: var(--sb) !important; }
.bs-total .bs-label { color: #94A3B8; }
.bs-total .bs-value { color: #fff; }
.tenant-note { padding: 10px 14px; background: #FEF2F2; border: 1px solid #FECACA; border-radius: 8px; font-size: 13px; color: #991B1B; }
.tenant-note strong { color: #DC2626; }
.tenant-note-ok { padding: 10px 14px; background: #F0FDF4; border: 1px solid #BBF7D0; border-radius: 8px; font-size: 13px; color: #166534; }
.tenant-chip { background: #FEF2F2 !important; border-left: 4px solid #DC2626 !important; animation: pulse-bg 2s ease-in-out infinite; }
.tenant-chip strong { color: #DC2626; }
.tenant-expense-row { background: #FEF2F2 !important; border-left: 4px solid #DC2626; }
.tenant-expense-row:hover { background: #FECACA !important; }
.tenant-badge { background: #DC262618 !important; color: #DC2626 !important; border: 1px solid #DC262644 !important; }
.tenant-amt { color: #DC2626 !important; }
.auto-tag { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: var(--text2); background: var(--bg); padding: 3px 8px; border-radius: 4px; }
.tfoot-row { background: #F8FAFC; border-top: 2px solid var(--border); }
.tfoot-row td { padding: 10px 12px; }

/* ═══════════════ FORMS ═══════════════ */
.row-form { display: flex; flex-wrap: wrap; gap: 10px; align-items: flex-end; }
.row-form input, .row-form select { padding: 9px 11px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; flex: 1; min-width: 130px; background: #fff; color: var(--text); transition: border-color .15s; }
.row-form input:focus, .row-form select:focus { outline: none; border-color: var(--pri); box-shadow: 0 0 0 3px rgba(79,70,229,.12); }

.util-form .uf-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap: 14px; }
.fg { display: flex; flex-direction: column; gap: 5px; }
.fg label { font-size: 13px; font-weight: 600; color: var(--text2); }
.fg input { padding: 9px 11px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; background: #fff; }
.fg input:focus { outline: none; border-color: var(--pri); box-shadow: 0 0 0 3px rgba(79,70,229,.12); }
.uf-actions { display: flex; align-items: center; gap: 14px; margin-top: 18px; }
.tot-badge { font-size: 16px; font-weight: 800; color: var(--pri); background: #EEF2FF; padding: 7px 14px; border-radius: 8px; }

/* ═══════════════ TABLES ═══════════════ */
.tbl-wrap { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; font-size: 14px; }
thead th { text-align: left; padding: 9px 12px; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .5px; color: var(--text2); border-bottom: 2px solid var(--border); background: #F8FAFC; }
tbody td { padding: 9px 12px; border-bottom: 1px solid var(--border); vertical-align: middle; }
tbody tr:hover { background: #F8FAFC; }
tbody tr:last-child td { border-bottom: none; }
.amt { font-weight: 700; font-variant-numeric: tabular-nums; }
.inc-amt { color: var(--green); }
.empty-row { text-align: center; color: var(--text2); font-style: italic; padding: 28px 12px !important; }
.badge { display: inline-flex; align-items: center; gap: 4px; padding: 2px 9px; border-radius: 20px; font-size: 11px; font-weight: 600; white-space: nowrap; }
.actions { display: flex; gap: 4px; }
.actions button { background: none; border: none; cursor: pointer; font-size: 15px; padding: 3px 5px; border-radius: 6px; }
.actions button:hover { background: var(--bg); }
.filter-sel { padding: 5px 9px; border: 1px solid var(--border); border-radius: 8px; font-size: 12px; background: #fff; }

/* ═══════════════ CHIPS ═══════════════ */
.chip-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 9px; }
.chip { padding: 9px 12px; background: #F8FAFC; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 12px; border: 1px solid var(--border); }
.chip strong { font-size: 13px; }

/* ═══════════════ UTILITY SPLIT ═══════════════ */
.tab-bar { display: flex; gap: 4px; margin-bottom: 22px; background: var(--bg); padding: 4px; border-radius: 10px; }
.tab { flex: 1; padding: 9px; border: none; background: none; font-size: 14px; font-weight: 600; border-radius: 8px; cursor: pointer; color: var(--text2); transition: all .15s; }
.tab.on { background: #fff; color: var(--pri); box-shadow: var(--shadow); }
.split-view h3 { margin-bottom: 14px; }
.split-rows { display: flex; flex-direction: column; gap: 2px; margin-bottom: 18px; }
.sr { display: flex; justify-content: space-between; padding: 9px 12px; background: #F8FAFC; border-radius: 6px; font-size: 14px; }
.sr.sub { background: #EEF2FF; color: var(--pri); font-weight: 600; }
.sr.total { background: var(--pri); color: #fff; font-weight: 700; font-size: 15px; border-radius: 8px; }
.info-box { padding: 10px 14px; border-radius: 8px; font-size: 13px; line-height: 1.5; }
.info-box.ok { background: #D1FAE5; color: #065F46; border: 1px solid #A7F3D0; }
.info-box.warn { background: #FEF3C7; color: #92400E; border: 1px solid #FDE68A; }
.landlord-note { font-size: 13px; color: var(--text2); margin-bottom: 14px; line-height: 1.5; }
.mini-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 18px; }
.mc { background: var(--bg); border-radius: 10px; padding: 14px; text-align: center; display: flex; flex-direction: column; gap: 5px; border: 1px solid var(--border); }
.mc span { font-size: 11px; color: var(--text2); font-weight: 500; }
.mc strong { font-size: 17px; }
.mc.mc-green { background: #F0FDF4; border-color: #BBF7D0; }
.mc.mc-green strong { color: var(--green); }
.mc.mc-highlight { background: #EEF2FF; border-color: #C7D2FE; }
.mc.mc-highlight strong { color: var(--pri); }

/* Overage result */
.overage-result { border-radius: 12px; padding: 18px; margin-bottom: 14px; text-align: center; }
.overage-result.over { background: linear-gradient(135deg, #FEF2F2, #FECACA); border: 2px solid #F87171; }
.overage-result.under { background: linear-gradient(135deg, #F0FDF4, #BBF7D0); border: 2px solid #4ADE80; }
.or-calc { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 14px; font-size: 18px; font-weight: 700; color: #991B1B; }
.or-minus, .or-equals { color: #DC2626; }
.or-label { display: block; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
.over .or-label { color: #991B1B; }
.under .or-label { color: #166534; }
.or-value { font-size: 32px; font-weight: 900; }
.over .or-value { color: #DC2626; }
.under .or-value { color: #16A34A; }

/* Rules */
.rules-card { border: 1px dashed var(--pri); background: #FAFAFE; }
.rules-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap: 10px; }
.rule { display: flex; align-items: flex-start; gap: 8px; padding: 10px; background: #F8FAFC; border-radius: 8px; border: 1px solid var(--border); font-size: 12px; line-height: 1.4; }
.rule-icon { font-size: 20px; }
.rule strong { color: var(--text); }
.rule-cap { background: #FEF3C7 !important; border-color: #FDE68A !important; grid-column: 1/-1; }
.rule-cap strong { color: #92400E; }

/* ═══════════════ SETTINGS ═══════════════ */
.desc { color: var(--text2); font-size: 14px; margin-bottom: 20px; }
.set-section { padding: 16px 0; border-bottom: 1px solid var(--border); }
.set-section:last-child { border-bottom: none; }
.set-section h4 { font-size: 15px; margin-bottom: 5px; }
.set-section p { font-size: 13px; color: var(--text2); margin-bottom: 10px; }
.notif-stat { display: inline-block; margin-left: 10px; font-size: 12px; color: var(--text2); padding: 3px 9px; background: var(--bg); border-radius: 6px; }
.set-actions { display: flex; gap: 8px; flex-wrap: wrap; }

.file-status-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px; }
.fs-card { display: flex; align-items: center; gap: 12px; padding: 14px; background: #F8FAFC; border-radius: 10px; border: 1px solid var(--border); }
.fs-card.connected { background: #F0FDF4; border-color: #BBF7D0; }
.fs-card.disconnected { background: #FEF2F2; border-color: #FECACA; }
.fs-icon { font-size: 24px; }
.fs-card strong { font-size: 14px; display: block; margin-bottom: 2px; }
.fs-card p { font-size: 12px; color: var(--text2); margin: 0; }

/* ═══════════════ RESPONSIVE ═══════════════ */
@media (max-width: 1024px) {
  .charts-row { grid-template-columns: 1fr; }
  .mini-cards, .budget-summary-grid, .file-status-grid { grid-template-columns: 1fr; }
  .tenant-overage-banner { flex-direction: column; gap: 14px; text-align: center; }
  .tob-left { flex-direction: column; text-align: center; }
}
@media (max-width: 768px) {
  .sidebar { width: 0; overflow: hidden; }
  .sidebar.open { width: 260px; box-shadow: 4px 0 20px rgba(0,0,0,.3); }
  .main { margin-left: 0 !important; }
  .mob-menu { display: block; }
  .topbar { padding: 0 12px; flex-wrap: wrap; height: auto; min-height: 64px; gap: 6px; padding-top: 8px; padding-bottom: 8px; }
  .tb-left h1 { font-size: 15px; }
  .content { padding: 16px; }
  .cards-grid { grid-template-columns: 1fr 1fr; }
  .row-form { flex-direction: column; }
  .row-form input, .row-form select { min-width: auto; }
  .chip-grid { grid-template-columns: 1fr; }
  .util-form .uf-grid { grid-template-columns: 1fr; }
  .rules-grid { grid-template-columns: 1fr; }
  .file-banner { flex-direction: column; text-align: center; }
  .fb-actions { margin-left: 0; }
  .sheet-badge-bar { flex-wrap: wrap; gap: 6px; padding: 8px 16px; }
  .tb-divider { display: none; }
}
@media (max-width: 480px) {
  .cards-grid { grid-template-columns: 1fr; }
}

/* Scrollbar */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }

/* Animations */
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.card, .sum-card, .chart-card { animation: fadeIn .3s ease; }
.recharts-wrapper { font-size: 12px; }